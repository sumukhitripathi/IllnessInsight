{% extends "base.html" %}

{% block title %}Health Coach - IntelliMed{% endblock %}

{% block content %}
<div class="container-fluid mt-5 pt-4">
    <!-- Header -->
    <div class="row mb-4">
        <div class="col-12">
            <div class="card bg-gradient-success text-white">
                <div class="card-body">
                    <div class="row align-items-center">
                        <div class="col-lg-8">
                            <h2 class="card-title mb-2">
                                <i class="fas fa-heartbeat me-2"></i>Personal Health Coach
                            </h2>
                            <p class="card-text mb-0">
                                Set goals, track progress, and receive AI-powered coaching for your wellness journey.
                            </p>
                        </div>
                        <div class="col-lg-4 text-lg-end">
                            <button class="btn btn-light" data-bs-toggle="modal" data-bs-target="#goalModal">
                                <i class="fas fa-plus me-2"></i>Add Goal
                            </button>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Quick Stats -->
    <div class="row mb-4">
        <div class="col-lg-3 col-md-6 mb-3">
            <div class="card text-center h-100">
                <div class="card-body">
                    <div class="mb-2">
                        <i class="fas fa-bullseye text-primary" style="font-size: 2rem;"></i>
                    </div>
                    <h4 id="total-goals" class="mb-1">0</h4>
                    <p class="text-muted mb-0">Active Goals</p>
                </div>
            </div>
        </div>
        
        <div class="col-lg-3 col-md-6 mb-3">
            <div class="card text-center h-100">
                <div class="card-body">
                    <div class="mb-2">
                        <i class="fas fa-check-circle text-success" style="font-size: 2rem;"></i>
                    </div>
                    <h4 id="completed-goals" class="mb-1">0</h4>
                    <p class="text-muted mb-0">Completed</p>
                </div>
            </div>
        </div>
        
        <div class="col-lg-3 col-md-6 mb-3">
            <div class="card text-center h-100">
                <div class="card-body">
                    <div class="mb-2">
                        <i class="fas fa-chart-line text-info" style="font-size: 2rem;"></i>
                    </div>
                    <h4 id="avg-progress" class="mb-1">0%</h4>
                    <p class="text-muted mb-0">Avg Progress</p>
                </div>
            </div>
        </div>
        
        <div class="col-lg-3 col-md-6 mb-3">
            <div class="card text-center h-100">
                <div class="card-body">
                    <div class="mb-2">
                        <i class="fas fa-calendar-week text-warning" style="font-size: 2rem;"></i>
                    </div>
                    <h4 id="streak-days" class="mb-1">0</h4>
                    <p class="text-muted mb-0">Day Streak</p>
                </div>
            </div>
        </div>
    </div>

    <div class="row">
        <!-- Goals List -->
        <div class="col-lg-8 mb-4">
            <div class="card">
                <div class="card-header d-flex justify-content-between align-items-center">
                    <h5 class="mb-0">
                        <i class="fas fa-list me-2"></i>Your Health Goals
                    </h5>
                    <div class="btn-group" role="group">
                        <input type="radio" class="btn-check" name="goalFilter" id="all-goals" autocomplete="off" checked>
                        <label class="btn btn-outline-primary btn-sm" for="all-goals">All</label>
                        
                        <input type="radio" class="btn-check" name="goalFilter" id="active-goals" autocomplete="off">
                        <label class="btn btn-outline-primary btn-sm" for="active-goals">Active</label>
                        
                        <input type="radio" class="btn-check" name="goalFilter" id="completed-goals-filter" autocomplete="off">
                        <label class="btn btn-outline-primary btn-sm" for="completed-goals-filter">Completed</label>
                    </div>
                </div>
                <div class="card-body">
                    <div id="goals-container">
                        <div class="text-center py-5">
                            <i class="fas fa-bullseye text-muted" style="font-size: 4rem;"></i>
                            <h5 class="text-muted mt-3">No goals yet</h5>
                            <p class="text-muted">Start your health journey by adding your first goal!</p>
                            <button class="btn btn-primary" data-bs-toggle="modal" data-bs-target="#goalModal">
                                <i class="fas fa-plus me-2"></i>Add Your First Goal
                            </button>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Progress Overview -->
        <div class="col-lg-4 mb-4">
            <div class="card mb-3">
                <div class="card-header">
                    <h6 class="mb-0">
                        <i class="fas fa-chart-pie me-2"></i>Progress Overview
                    </h6>
                </div>
                <div class="card-body">
                    <canvas id="progressChart" width="400" height="200"></canvas>
                </div>
            </div>

            <!-- AI Coaching Tips -->
            <div class="card">
                <div class="card-header">
                    <h6 class="mb-0">
                        <i class="fas fa-brain me-2"></i>AI Coaching Tips
                    </h6>
                </div>
                <div class="card-body">
                    <div id="coaching-tips">
                        <div class="d-flex align-items-center">
                            <i class="fas fa-lightbulb text-warning me-3"></i>
                            <div>
                                <small class="text-muted">Add some goals to get personalized coaching tips!</small>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>

<!-- Add/Edit Goal Modal -->
<div class="modal fade" id="goalModal" tabindex="-1">
    <div class="modal-dialog modal-lg">
        <div class="modal-content">
            <div class="modal-header">
                <h5 class="modal-title">
                    <i class="fas fa-plus-circle me-2"></i>Add Health Goal
                </h5>
                <button type="button" class="btn-close" data-bs-dismiss="modal"></button>
            </div>
            <div class="modal-body">
                <form id="goal-form">
                    <div class="row">
                        <div class="col-md-6 mb-3">
                            <label for="goal-type" class="form-label">Goal Type</label>
                            <select class="form-select" id="goal-type" required>
                                <option value="">Choose goal type...</option>
                                <option value="fitness">Fitness & Exercise</option>
                                <option value="nutrition">Nutrition & Diet</option>
                                <option value="weight">Weight Management</option>
                                <option value="wellness">General Wellness</option>
                                <option value="sleep">Sleep Quality</option>
                                <option value="mental">Mental Health</option>
                            </select>
                        </div>
                        
                        <div class="col-md-6 mb-3">
                            <label for="goal-title" class="form-label">Goal Title</label>
                            <input type="text" class="form-control" id="goal-title" 
                                   placeholder="e.g., Walk 10,000 steps daily" required>
                        </div>
                    </div>
                    
                    <div class="mb-3">
                        <label for="goal-description" class="form-label">Description</label>
                        <textarea class="form-control" id="goal-description" rows="3"
                                  placeholder="Describe your goal and why it's important to you..."></textarea>
                    </div>
                    
                    <div class="row">
                        <div class="col-md-4 mb-3">
                            <label for="target-value" class="form-label">Target Value</label>
                            <input type="number" class="form-control" id="target-value" 
                                   placeholder="10000" step="0.01" required>
                        </div>
                        
                        <div class="col-md-4 mb-3">
                            <label for="goal-unit" class="form-label">Unit</label>
                            <input type="text" class="form-control" id="goal-unit" 
                                   placeholder="steps, kg, minutes, etc.">
                        </div>
                        
                        <div class="col-md-4 mb-3">
                            <label for="target-date" class="form-label">Target Date</label>
                            <input type="date" class="form-control" id="target-date">
                        </div>
                    </div>
                </form>
                
                <!-- AI Goal Suggestions -->
                <div id="ai-suggestions" class="mt-4" style="display: none;">
                    <h6 class="text-primary">
                        <i class="fas fa-brain me-2"></i>AI Goal Suggestions
                    </h6>
                    <div id="suggestions-container" class="row">
                        <!-- AI suggestions will be loaded here -->
                    </div>
                </div>
            </div>
            <div class="modal-footer">
                <button type="button" class="btn btn-outline-primary" id="get-suggestions-btn">
                    <i class="fas fa-magic me-2"></i>Get AI Suggestions
                </button>
                <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Cancel</button>
                <button type="submit" class="btn btn-primary" form="goal-form">
                    <i class="fas fa-save me-2"></i>Save Goal
                </button>
            </div>
        </div>
    </div>
</div>

<!-- Progress Update Modal -->
<div class="modal fade" id="progressModal" tabindex="-1">
    <div class="modal-dialog">
        <div class="modal-content">
            <div class="modal-header">
                <h5 class="modal-title">
                    <i class="fas fa-chart-line me-2"></i>Update Progress
                </h5>
                <button type="button" class="btn-close" data-bs-dismiss="modal"></button>
            </div>
            <div class="modal-body">
                <form id="progress-form">
                    <input type="hidden" id="progress-goal-id">
                    
                    <div class="mb-3">
                        <label for="current-value" class="form-label">Current Value</label>
                        <div class="input-group">
                            <input type="number" class="form-control" id="current-value" 
                                   step="0.01" required>
                            <span class="input-group-text" id="progress-unit"></span>
                        </div>
                    </div>
                    
                    <div class="mb-3">
                        <label class="form-label">Progress</label>
                        <div class="progress mb-2">
                            <div class="progress-bar" id="progress-preview" 
                                 role="progressbar" style="width: 0%">0%</div>
                        </div>
                    </div>
                </form>
            </div>
            <div class="modal-footer">
                <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Cancel</button>
                <button type="submit" class="btn btn-primary" form="progress-form">
                    <i class="fas fa-save me-2"></i>Update Progress
                </button>
            </div>
        </div>
    </div>
</div>
{% endblock %}

{% block extra_scripts %}
<script src="{{ url_for('static', filename='js/health_coach.js') }}"></script>

<style>
    .bg-gradient-success {
        background: linear-gradient(135deg, #28a745 0%, #20c997 100%) !important;
    }

    .goal-card {
        border-left: 4px solid transparent;
        transition: all 0.3s ease;
    }

    .goal-card:hover {
        transform: translateY(-2px);
        box-shadow: 0 4px 12px rgba(0,0,0,0.1);
    }

    .goal-type-fitness { border-left-color: #007bff; }
    .goal-type-nutrition { border-left-color: #28a745; }
    .goal-type-weight { border-left-color: #ffc107; }
    .goal-type-wellness { border-left-color: #17a2b8; }
    .goal-type-sleep { border-left-color: #6f42c1; }
    .goal-type-mental { border-left-color: #e83e8c; }

    .progress-ring {
        position: relative;
        display: inline-block;
    }

    .suggestion-card {
        cursor: pointer;
        transition: all 0.3s ease;
    }

    .suggestion-card:hover {
        transform: translateY(-2px);
        box-shadow: 0 4px 12px rgba(0,0,0,0.1);
    }

    .coaching-tip {
        background: linear-gradient(45deg, #f8f9fa, #e9ecef);
        border-radius: 10px;
        padding: 1rem;
        margin-bottom: 1rem;
    }

    .modal-lg {
        max-width: 800px;
    }

    #progressChart {
        max-height: 200px;
    }
</style>
{% endblock %}
